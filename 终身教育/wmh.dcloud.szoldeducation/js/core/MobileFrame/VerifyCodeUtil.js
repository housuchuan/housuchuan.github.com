define(function(require,a,e){var b=4;function g(i){var h={str:["a","b","c","d","e","f","g","h","i","j","k","l","m","o","p","q","r","s","t","x","u","v","y","z","w","n","0","1","2","3","4","5","6","7","8","9"],randint:function(o,j){var l=j-o+1;var k=Math.random()*l+o;return Math.floor(k)},randStr:function(){var l=this;var j=l.str.length-1;var k=l.randint(0,j);return l.str[k]},create:function(j){var o=this;var k=j||b;var n="";for(var m=0;m<k;m++){n+=o.randStr()}return n}};i=i?i:b;return h.create(i)}function f(k,h){var j=h-k+1;var i=Math.random()*j+k;return Math.floor(i)}function d(i,h){this.codeDoms=[];this.lineDoms=[];this.initOptions(h);this.dom=i;this.init();this.addEvent();this.update();this.mask()}d.prototype.init=function(){this.dom.style.position="relative";this.dom.style.overflow="hidden";this.dom.style.cursor="pointer";this.dom.title="点击更换验证码";this.dom.style.background=this.options.bgColor;this.w=this.dom.clientWidth;this.h=this.dom.clientHeight;this.uW=this.w/this.options.len};d.prototype.mask=function(){var h=document.createElement("div");h.style.cssText=["width: 100%","height: 100%","left: 0","top: 0","position: absolute","cursor: pointer","z-index: 9999999"].join(";");h.title="点击更换验证码";this.maskDom=h;this.dom.appendChild(h)};d.prototype.addEvent=function(){var h=this;h.dom.addEventListener("click",function(){h.update.call(h)})};d.prototype.initOptions=function(h){var k=function(){this.len=b;this.fontSizeMin=20;this.fontSizeMax=48;this.sizeWeight=30;this.colors=["green","red","blue","#53da33","#AA0000","#FFBB00"];this.bgColor="#FFF";this.fonts=["Times New Roman","Georgia","Serif","sans-serif","arial","tahoma","Hiragino Sans GB"];this.lines=8;this.lineColors=["#888888","#FF7744","#888800","#008888"];this.lineHeightMin=1;this.lineHeightMax=3;this.lineWidthMin=1;this.lineWidthMax=60};this.options=new k();if(typeof h==="object"){for(var j in h){this.options[j]=h[j]}}};d.prototype.update=function(){if(!this.dom){return}for(var h=0;h<this.codeDoms.length;h++){this.dom.removeChild(this.codeDoms[h])}for(var h=0;h<this.lineDoms.length;h++){this.dom.removeChild(this.lineDoms[h])}this.createCode();this.draw()};d.prototype.createCode=function(){this.code=g(this.options.len)};d.prototype.verify=function(h){return this.code===h};d.prototype.draw=function(){if(!this.dom){return}this.codeDoms=[];for(var h=0;h<this.code.length;h++){this.codeDoms.push(this.drawCode(this.code[h],h))}this.drawLines()};d.prototype.drawCode=function(j,h){var k=document.createElement("span");var i=this.options.sizeWeight;k.style.cssText=["font-size:"+f(this.options.fontSizeMin,this.options.fontSizeMax)+"px","color:"+this.options.colors[f(0,this.options.colors.length-1)],"position: absolute","left:"+f(this.uW*h,this.uW*h+this.uW-10)+"px","top:"+f(0,this.h-i)+"px","transform:rotate("+f(-i,i)+"deg)","-ms-transform:rotate("+f(-i,i)+"deg)","-moz-transform:rotate("+f(-i,i)+"deg)","-webkit-transform:rotate("+f(-i,i)+"deg)","-o-transform:rotate("+f(-i,i)+"deg)","font-family:"+this.options.fonts[f(0,this.options.fonts.length-1)],"font-weight:"+f(400,900)].join(";");k.innerHTML=j;this.dom.appendChild(k);return k};d.prototype.drawLines=function(){this.lineDoms=[];var j=this.options.sizeWeight;for(var h=0;h<this.options.lines;h++){var k=document.createElement("div");k.style.cssText=["position: absolute","opacity: "+f(3,8)/10,"width:"+f(this.options.lineWidthMin,this.options.lineWidthMax)+"px","height:"+f(this.options.lineHeightMin,this.options.lineHeightMax)+"px","background: "+this.options.lineColors[f(0,this.options.lineColors.length-1)],"left:"+f(0,this.w-20)+"px","top:"+f(0,this.h)+"px","transform:rotate("+f(-j,j)+"deg)","-ms-transform:rotate("+f(-j,j)+"deg)","-moz-transform:rotate("+f(-j,j)+"deg)","-webkit-transform:rotate("+f(-j,j)+"deg)","-o-transform:rotate("+f(-j,j)+"deg)","font-family:"+this.options.fonts[f(0,this.options.fonts.length-1)],"font-weight:"+f(400,900)].join(";");this.dom.appendChild(k);this.lineDoms.push(k)}};d.prototype.dispose=function(){this.maskDom&&this.maskDom.parentNode.removeChild(this.maskDom);this.maskDom=null;if(this.lineDoms){for(var h=0;h<this.lineDoms.length;h++){this.lineDoms[h].parentNode.removeChild(this.lineDoms[h])}}this.lineDoms=null;if(this.codeDoms){for(var h=0;h<this.codeDoms.length;h++){this.codeDoms[h].parentNode.removeChild(this.codeDoms[h])}}this.codeDoms=null;this.dom=null;this.code=null};a.generateVerifyCode=function(j,h){var i=new d(j,h);return i}});