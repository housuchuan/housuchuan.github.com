define(function(require,f,d){var g=require("core/MobileFrame/CommonUtil");function c(j,k){k=(k!=null&&k instanceof HTMLElement)?k:document;return k.getElementById(j)}function a(k,j){j=(j!=null&&j instanceof HTMLElement)?j:document;k=k.replace(/\./g,"");return j.getElementsByClassName(k)}function h(k,j){j=(j!=null&&j instanceof HTMLElement)?j:document;return j.getElementsByTagName(k)}f.$domByStr=function(l,j){if(l==null){return null}if(l instanceof HTMLElement){return l}else{if(typeof(l)!="string"){return null}}j=(j!=null&&j instanceof HTMLElement)?j:document;if(l.indexOf("#")!=-1){l=l.replace(/\#/g,"");var k=c(l,j);if(k!=null){return k}}else{if(l.indexOf(".")!=-1){l=l.replace(/\./g,"");var m=a(l,j);if(m!=null&&m.length>0){return m[0]}}else{var n=h(l,j);if(n!=null&&n.length>0){return n[0]}}}return null};f.$hasClass=function(k,j){if(!(k instanceof HTMLElement)){return false}j=j.replace(/^\s|\s$/g,"");return(" "+((k||{}).className||"").replace(/\s/g," ")+" ").indexOf(" "+j+" ")>=0};f.getChildElemLength=function(j){if(!(j instanceof HTMLElement)){return 0}return j.children.length};f.pareseStringToHtml=function(m){if(m==null||typeof(m)!="string"){return null}var l,k=document.createElement("div");var j=document.createDocumentFragment();k.innerHTML=m;while(l=k.firstChild){j.appendChild(l)}return j};f.appendHtmlChildCustom=function(k,j){if(k==null||j==null||!(k instanceof HTMLElement)){return}if(j instanceof HTMLElement){k.appendChild(j)}else{var l=f.pareseStringToHtml(j);if(l!=null){k.appendChild(l)}}};f.ShiedScript=function(j){j=j||"";j=j.replace(new RegExp("<object[^]*>[\\s\\S]*?</object>","gi"),"");return j.replace(new RegExp("<script[^]*>[\\s\\S]*?<\/script>","gi"),"")};f.HandleComplexTextHtml=function(o,j){if(!g.IsInclude("zepto.min.js")){console.error("错误:没有添加zepto引用!");return}var p=Zepto("img",Zepto(o));Zepto.each(p,function(r,s){var q=Zepto(this).attr("src");Zepto(this).attr("src","");Zepto(this).attr("data-img-localcache",q)});var l=Zepto("a",Zepto(o));Zepto.each(l,function(r,s){var q=Zepto(this).attr("href");Zepto(this).attr("href","javascript:void(0)");Zepto(this).attr("id",q);Zepto(this).on("tap",function(){if(j&&typeof(j)=="function"){j(q)}})});var m=Zepto("embed",Zepto(o));Zepto.each(m,function(r,s){var q=Zepto(this).attr("src");Zepto(this).attr("src",q)});var n=Zepto("script",Zepto(o));Zepto.each(n,function(q,r){Zepto(this).remove()});var k=Zepto("object",Zepto(o));Zepto.each(k,function(q,r){Zepto(this).remove()})};f.appendComplexHtml=function(k,l,j){if(!g.IsInclude("zepto.min.js")){console.error("错误:没有添加zepto引用!");return}if(!(k instanceof HTMLElement)){console.error("目标dom不为htmldom,添加错误");return}l=l||"";l=f.ShiedScript(l);Zepto(k).append(l);f.HandleComplexTextHtml(k,j)};function b(j,k,m,l){if(window.FileReader||!j||!(j instanceof FileReader)){j.onload=function(n){m&&m(n.target.result)};if(l==="DataUrl"){j.readAsDataURL(k)}else{if(l==="Text"){j.readAsText(k)}else{j.readAsBinaryString(k)}}return j}else{console.error("错误:FileReader不存在!")}}function i(o,m,j){if(typeof o=="string"){o=document.querySelector(o)}if(!o||!(o instanceof HTMLElement)){console.error("错误:input file标签的dom为空！或者不为Html元素!")}j=j||{};o.setAttribute("type","file");if(j.isMulti){o.setAttribute("multiple","multiple")}else{o.removeAttribute("multiple")}var l="File";var k;if(j.type==="Image"){k="image/*";l="DataUrl"}else{if(j.type==="Text"){k="text/*";l="Text"}else{k="*";l="File"}}k=j.filter||k;o.setAttribute("accept",k);var n=function(){var t=document.getElementById("file").files;var q=t.length;if(q===0){return}var r=new window.FileReader();var s=0;var p=function(){if(s>=q){return}b(r,t[s],function(u){m&&m(u);s++;p()},l)};p()};o.removeEventListener("change",n);o.addEventListener("change",n)}f.setSelectImgsFromDisks=function(l,k,j){i(l,k,{isMulti:j.isMulti||false,filter:j.filter||"image/*",type:"Image"})};f.setSelectFilesFromDisks=function(l,k,j){i(l,k,{isMulti:j.isMulti||false,filter:j.filter||"*",type:"File"})};f.setSelectTextsFromDisks=function(l,k,j){i(l,k,{isMulti:j.isMulti||false,filter:j.filter||"text/*",type:"Text"})}});