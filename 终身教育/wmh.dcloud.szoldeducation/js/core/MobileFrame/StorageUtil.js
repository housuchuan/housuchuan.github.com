define(function(c,a,d){var b={isDebug:false};a.setOptions=function(e){if(!e){return}for(var f in b){if(e[f]!==undefined){b[f]=e[f]}}};a.setStorageItem=function(g,e){e=e||"";if(typeof(e)=="string"){}else{e=JSON.stringify(e)}if(window.plus){plus.storage.setItem(g,e)}else{try{localStorage.setItem(g,e)}catch(f){console.error("localStorage存储值出错:"+g+","+JSON.stringify(f))}}};a.getStorageItem=function(j,g){g=typeof(g)=="boolean"?g:true;var f=null;if(window.plus){f=plus.storage.getItem(j)}else{try{f=localStorage.getItem(j)}catch(i){console.error("localStorage获取值出错:"+j+","+JSON.stringify(i))}}if(f!=null&&g){try{f=JSON.parse(f)}catch(h){}}return f};a.removeStorageItem=function(g){if(g!=null&&g!=""){if(window.plus){plus.storage.removeItem(g)}else{try{localStorage.removeItem(g)}catch(f){console.error("localStorage删除值出错:"+g+","+JSON.stringify(msg))}}}};a.clearAllStorageItem=function(){if(window.plus){plus.storage.clear()}else{try{localStorage.clear()}catch(f){console.error("localStorage清空时出错:,"+JSON.stringify(msg))}}};(function(f){var e="MyOffLineAppCache";f.clearAllOffLineAppCache=function(){var g=a.getStorageItem(e);if(g!=null&&Array.isArray(g)){for(var h=0;h<g.length;h++){a.removeStorageItem(g[h]);f.deleteOffLineCache(g[h])}}};f.addOffLineCache=function(i,j){var h=a.getStorageItem(e);if(h==null){h=[]}if(b.isDebug==true){console.log("key:"+i+",addOffLineCache增加前的值:"+JSON.stringify(h))}var g=null;if(typeof(j)=="string"){g=j}else{if(j!=null){g=JSON.stringify(j)}}h.push(i);a.setStorageItem(e,h);if(b.isDebug==true){console.log("添加数据:key:"+i+",value:"+g)}a.setStorageItem(i,g);if(b.isDebug==true){console.log("key:"+i+",addOffLineCache增加后的值:"+JSON.stringify(h))}};f.getOffLineCache=function(h,g){return a.getStorageItem(h,g)};f.deleteOffLineCache=function(i){var g=a.getStorageItem(e);if(g==null||!Array.isArray(g)){return}var h=g.indexOf(i);g.splice(h,1);a.removeStorageItem(i);if(b.isDebug==true){console.log("删除后离线管理:"+JSON.stringify(g))}a.setStorageItem(e,g)};f.IsHasOffLineCache=function(i){var j=false;var g=a.getStorageItem(e);if(g==null||!Array.isArray(g)){return j}var h=g.indexOf(i);if(h!=-1){j=true}return j};f.addListDataCache=function(g,l,k){var h=f.getOffLineCache(g);if(h==null||!Array.isArray(h)){h=[]}if(typeof(l)=="string"){try{l=JSON.parse(l)}catch(m){if(b.isDebug==true){console.log("addListCache,将列表字符串数据转为json时出错")}}}if(k!=null){k=parseInt(k)}if(k==null||isNaN(k)||k<0){return}if(l==null||!Array.isArray(l)){if(b.isDebug==true){console.log("addListCache,存储数据格式不对,传入非JSON数组格式")}return}if(b.isDebug==true){console.log("addListCache,加入前的数据:"+JSON.stringify(h))}if(h.length<=k){Array.prototype.push.apply(h,l)}else{if(b.isDebug==true){console.log("插入数组长度:"+l.length+",beginIndex:"+k)}var j=h.slice(0,k);var i=h.slice(k+l.length);Array.prototype.push.apply(j,l);if(i!=null){Array.prototype.push.apply(j,i)}h=j}f.addOffLineCache(g,h);if(b.isDebug==true){console.log("addListCache,key"+g+",加入后的数据:"+JSON.stringify(h))}};f.getListDataCache=function(g,n,j){var i=f.getOffLineCache(g);var h=0;if(i!=null&&Array.isArray(i)){h=i.length}if(b.isDebug==true){console.log("getListDataCache,总共的离线数据:"+JSON.stringify(i))}var l=null;var k=null;if(n!=null){l=parseInt(n)}if(j!=null){k=parseInt(j)}if(l==null||isNaN(l)){l=0}if(k==null||isNaN(k)){k=1}if(b.isDebug==true){console.log("当前页:"+l+",页面大小:"+k)}var m={totalCount:h,data:null};if(i!=null){m.data=i.slice(l*k,(l+1)*k)}i=null;return m}})(a.OffLineAppCache={})});