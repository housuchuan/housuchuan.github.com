define(function(require,exports,module){"use strict";function e(e,t){return t=null!=t&&t instanceof HTMLElement?t:document,t.getElementById(e)}function t(e,t){return t=null!=t&&t instanceof HTMLElement?t:document,e=e.replace(/\./g,""),t.getElementsByClassName(e)}function n(e,t){return t=null!=t&&t instanceof HTMLElement?t:document,t.getElementsByTagName(e)}var l=require("CommonTools_Core");exports.$domByStr=function(l,r){if(null==l)return null;if(l instanceof HTMLElement)return l;if("string"!=typeof l)return null;if(r=null!=r&&r instanceof HTMLElement?r:document,l.indexOf("#")!=-1){l=l.replace(/\#/g,"");var i=e(l,r);if(null!=i)return i}else if(l.indexOf(".")!=-1){l=l.replace(/\./g,"");var c=t(l,r);if(null!=c&&c.length>0)return c[0]}else{var u=n(l,r);if(null!=u&&u.length>0)return u[0]}return null},exports.$hasClass=function(e,t){return e instanceof HTMLElement&&(t=t.replace(/^\s|\s$/g,""),(" "+((e||{}).className||"").replace(/\s/g," ")+" ").indexOf(" "+t+" ")>=0)},exports.getChildElemLength=function(e){return e instanceof HTMLElement?e.children.length:0},exports.pareseStringToHtml=function(e){if(null==e||"string"!=typeof e)return null;var t,n=document.createElement("div"),l=document.createDocumentFragment();for(n.innerHTML=e;t=n.firstChild;)l.appendChild(t);return l},exports.appendHtmlChildCustom=function(e,t){if(null!=e&&null!=t&&e instanceof HTMLElement)if(t instanceof HTMLElement)e.appendChild(t);else{var n=exports.pareseStringToHtml(t);null!=n&&e.appendChild(n)}},exports.ShiedScript=function(e){return e=e||"",e=e.replace(new RegExp("<object[^]*>[\\s\\S]*?</object>","gi"),""),e.replace(new RegExp("<script[^]*>[\\s\\S]*?</script>","gi"),"")},exports.HandleComplexTextHtml=function(e,t){var n=e.querySelectorAll("img");l.each(n,function(e,t){var n=this.getAttribute("src");this.setAttribute("src",""),this.setAttribute("data-img-localcache",n)});var r=e.querySelectorAll("a");l.each(r,function(e,n){var l=this.getAttribute("href");this.setAttribute("href","javascript:void(0)"),this.setAttribute("target-link-url",l),this.addEventListener("click",function(){t&&"function"==typeof t&&t(l)})});var i=e.querySelectorAll("embed");l.each(i,function(e,t){this.getAttribute("src");this.setAttribute("src","")});var c=e.querySelectorAll("object");l.each(c,function(e,t){this.parentNode.removeChild(this)})},exports.appendComplexHtml=function(e,t,n){return e instanceof HTMLElement?(t=t||"",t=exports.ShiedScript(t),exports.appendHtmlChildCustom(e,t),void exports.HandleComplexTextHtml(e,n)):void console.error("目标dom不为htmldom,添加错误")}});