define(function(require,exports,module){"use strict";function e(e,t,i,a){return!window.FileReader&&e&&e instanceof FileReader?void console.error("错误:FileReader不存在!"):(e.onload=function(e){var l=e.target.result;if("DataUrl"===a&&l&&l.indexOf("data:base64,")!==-1){l=l.replace("data:base64,","");var n="",r=t.name;r&&r.toLowerCase().indexOf(".jpg")!==-1?n="image/jpeg":r&&r.toLowerCase().indexOf(".png")!==-1?n="image/png":r&&r.toLowerCase().indexOf(".gif")!==-1?n="image/gif":r&&r.toLowerCase().indexOf(".icon")!==-1&&(n="image/x-icon"),l="data:"+n+";base64,"+l}i&&i(l)},"DataUrl"===a?e.readAsDataURL(t):"Text"===a?e.readAsText(t):e.readAsBinaryString(t),e)}function t(t,a,l){"string"==typeof t&&(t=document.querySelector(t)),t&&t instanceof HTMLElement||console.error("错误:input file标签的dom为空！或者不为Html元素!"),l=l||{},t.setAttribute("type","file"),l.isMulti?t.setAttribute("multiple","multiple"):t.removeAttribute("multiple");var n,r="File";"Image"===l.type?(n="image/*",r="DataUrl"):"Camera"===l.type?(n=i.os.ejs?"camera/*":"image/*",r="DataUrl"):"Image_Camera"===l.type?(n=i.os.ejs?"image_camera/*":"image/*",r="DataUrl"):"Image_File"===l.type?(n=i.os.ejs?"image_file/*":"*",r="DataUrl"):"Camera_File"===l.type?(n=i.os.ejs?"camera_file/*":"*",r="DataUrl"):"Text"===l.type?(n=i.os.ejs?"text/*":"file/*",r="Text"):"File"===l.type&&i.os.ejs?(n="file/*",r="DataUrl"):(n="*",r="File"),n=l.filter||n,t.setAttribute("accept",n);var o=function(){var i=t.files,l=i.length;if(0!==l){var n=new window.FileReader,o=0,s=function(){o>=l||e(n,i[o],function(e){a&&a(e,i[o]),o++,s()},r)};s()}};t.removeEventListener("change",o),t.addEventListener("change",o)}var i=require("CommonTools_Core");exports.delFile=function(e,t,a){e&&i.plusReady(function(){plus.io.resolveLocalFileSystemURL(e,function(e){e.remove(function(e){t&&"function"==typeof t&&t(!0)},function(e){a&&"function"==typeof a&&a("删除文件失败!")})},function(){a&&"function"==typeof a&&a("打开文件路径失败!")})})},exports.setSelectImgsFromDisks=function(e,i,a){t(e,i,{isMulti:a.isMulti||!1,filter:a.filter,type:"Image"})},exports.setSelectCameraFromDisks=function(e,i,a){t(e,i,{isMulti:a.isMulti||!1,filter:a.filter,type:"Camera"})},exports.setSelectFilesFromDisks=function(e,i,a){t(e,i,{isMulti:a.isMulti||!1,filter:a.filter,type:"File"})},exports.setSelectImageCameraFromDisks=function(e,i,a){t(e,i,{isMulti:a.isMulti||!1,filter:a.filter,type:"Image_Camera"})},exports.setSelectImageFileFromDisks=function(e,i,a){t(e,i,{isMulti:a.isMulti||!1,filter:a.filter,type:"Image_File"})},exports.setSelectCameraFileFromDisks=function(e,i,a){t(e,i,{isMulti:a.isMulti||!1,filter:a.filter,type:"Camera_File"})},exports.setSelectTextsFromDisks=function(e,i,a){t(e,i,{isMulti:a.isMulti||!1,filter:a.filter,type:"Text"})},exports.downloadLocalFile=function(e,t){var i=document.createElement("a"),a=new Blob([t]),l=document.createEvent("HTMLEvents");l.initEvent("click",!1,!1),i.download=e,i.href=URL.createObjectURL(a),i.dispatchEvent(l)}});